<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
  <meta charset="utf-8">

  <title>R 201: tables, filters and apply's, oh my!</title>
  <meta name="description" content="">

  <!-- Mobile viewport optimized: h5bp.com/viewport -->
  <meta name="viewport" content="width=device-width">

  <!-- Tell iOS to run as an app if launched from home screen -->
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/page.css">
  <link rel="stylesheet" href="css/code.css">
  <link rel="stylesheet" href="css/print.css">

  <!-- All JavaScript at the bottom, except this Modernizr build. -->
  <script src="js/vendor/modernizr-2.5.3.min.js" type="text/javascript"></script>
</head>

<body>
  <!-- Prompt IE 6 users to install Chrome Frame. -->
  <!--[if lt IE 9]>
    <p class=chromeframe>
      Your web browser is <em>ancient!</em> <a href="http://browsehappy.com/">You should upgrade to a new browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.
    </p>
  <![endif]-->

  <!-- courseR content will be injected here -->
  <div id = "courser-stuff" class = "pageView">
<section>  <h1>R 201:</h1>

<h3>Tables, filters and apply&#39;s, oh my!</h3>

<p><img src="http://imgs.xkcd.com/comics/well_2.png" alt="well"/></p>
</section>
<section><h1>RNA Transcribe Solutions</h1>

<section><h2>Yours&hellip;</h2>
</section>
<section><h2>Mine:</h2>

<pre class="knitr"><div class="source"><span class="symbol">transcribe</span> <span class="assignement">&lt;-</span> <span class="keyword">function</span><span class="keyword">(</span><span class="formalargs">dnaFile</span><span class="keyword">,</span> <span class="formalargs">rnaFile</span><span class="keyword">)</span> <span class="keyword">{</span>

  <span class="comment">#Read the file</span>
  <span class="symbol">dna</span> <span class="assignement">&lt;-</span> <span class="functioncall">readLines</span><span class="keyword">(</span><span class="symbol">dnaFile</span><span class="keyword">)</span>

  <span class="comment">#Substitute U's for T's</span>
  <span class="symbol">rna</span> <span class="assignement">&lt;-</span> <span class="functioncall">sub</span><span class="keyword">(</span> <span class="argument">pattern</span>     <span class="argument">=</span> <span class="string">"T"</span><span class="keyword">,</span>
              <span class="argument">replacement</span> <span class="argument">=</span> <span class="string">"U"</span><span class="keyword">,</span>
              <span class="argument">x</span>           <span class="argument">=</span> <span class="symbol">dna</span><span class="keyword">,</span>
              <span class="argument">fixed</span>       <span class="argument">=</span> <span class="number">TRUE</span>
            <span class="keyword">)</span>

  <span class="comment">#Save the results</span>
  <span class="functioncall">write</span><span class="keyword">(</span><span class="symbol">rna</span><span class="keyword">,</span> <span class="symbol">rnaFile</span><span class="keyword">)</span>

<span class="keyword">}</span></div></pre>

<p>Take a moment to see how I&#39;ve formatted the call to <code>sub</code>.  The formatting here is designed to make this function as easy to read as possible.  R doesn&#39;t care if your code is pretty or not; if it has correct syntax it will read it just fine (<a href="http://en.wikipedia.org/wiki/Lexical_analysis">lexical analysis</a>).  But if you write ugly code you and others will have trouble reading it in the future.  </p>
</section>
<section><h2>An ugly version</h2>

<p>This function is equivalent to the last one, but ugly.</p>

<pre class="knitr"><div class="source"><span class="symbol">transcribe</span> <span class="assignement">&lt;-</span> <span class="keyword">function</span><span class="keyword">(</span><span class="formalargs">f1</span><span class="keyword">,</span><span class="formalargs">f2</span><span class="keyword">)</span> <span class="keyword">{</span><span class="functioncall">write</span><span class="keyword">(</span><span class="functioncall">sub</span><span class="keyword">(</span><span class="string">"T"</span><span class="keyword">,</span><span class="string">"U"</span><span class="keyword">,</span><span class="functioncall">readLines</span><span class="keyword">(</span><span class="symbol">f1</span><span class="keyword">)</span><span class="keyword">,</span><span class="argument">fixed</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">)</span><span class="keyword">,</span> <span class="symbol">f2</span><span class="keyword">)</span><span class="keyword">}</span></div></pre>
</section>
<section><h2>To use it:</h2>

<pre class="knitr"><div class="source"><span class="functioncall">transcribe</span><span class="keyword">(</span><span class="string">"dna.txt"</span><span class="keyword">,</span> <span class="string">"rna.txt"</span><span class="keyword">)</span></div></pre>
</section></section>
<section><h1>So how would we tackle the translation problem?</h1>
</section>
<section><h1>Time for a table</h1>

<section><h2>It&#39;d be nice to be working with the genetic code in table format.</h2>
</section>
<section><h2>Look at the contents of translationTable.txt</h2>

<p>This is a &ldquo;tab-delimited&rdquo; file.</p>

<p>You can make one in a text editor, Excel, Minitab, etc&hellip;</p>
</section>
<section><h2>The read.* family of functions load tabular data into R</h2>

<pre class="knitr"><div class="source"><span class="comment">#Read a tab-delimited file</span>
<span class="symbol">translationTable</span> <span class="assignement">&lt;-</span> <span class="functioncall">read.delim</span><span class="keyword">(</span><span class="string">"translationTable.txt"</span><span class="keyword">,</span> <span class="argument">stringsAsFactors</span> <span class="argument">=</span> <span class="number">FALSE</span><span class="keyword">)</span></div></pre>

<p>What&#39;s up with the <code>stringsAsFactors = FALSE</code> part?  Factors are a more advanced topic, so we&#39;re not going to get into them today (but we <em>will</em>).  Try ommiting this argument to <code>read.delim</code> and see what happens when you run through the excercises below.  It&#39;s close to the same result.</p>
</section>
<section><h2>If you have comma-separated file</h2>

<pre class="knitr"><div class="source"><span class="symbol">myTable</span> <span class="assignement">&lt;-</span> <span class="functioncall">read.csv</span><span class="keyword">(</span><span class="string">"myTable.csv"</span><span class="keyword">)</span></div></pre>
</section>
<section><h2>If you need finer control over how the table is loaded</h2>

<pre class="knitr"><div class="source"><span class="keyword">?</span><span class="symbol">read.table</span></div></pre>
</section></section>
<section><h1>Tables</h1>

<section><h2>It&#39;s not a number, it&#39;s not a string&hellip;</h2>

<pre class="knitr"><div class="source"><span class="comment">#Class tells you what kind of data a variable holds</span>

<span class="comment">#So far we've seen</span>
<span class="functioncall">class</span><span class="keyword">(</span><span class="string">"hello"</span><span class="keyword">)</span></div><div class="output">[1] "character"
</div><div class="source"><span class="functioncall">class</span><span class="keyword">(</span><span class="number">100</span><span class="keyword">)</span></div><div class="output">[1] "numeric"
</div><div class="source">
<span class="comment">#We've also used TRUE as an argument for a function...</span>
<span class="functioncall">class</span><span class="keyword">(</span><span class="number">TRUE</span><span class="keyword">)</span></div><div class="output">[1] "logical"
</div><div class="source">
<span class="comment">#The other logical value is FALSE</span>
<span class="functioncall">class</span><span class="keyword">(</span><span class="number">FALSE</span><span class="keyword">)</span></div><div class="output">[1] "logical"
</div><div class="source">
<span class="comment">#So what's our translationTable?</span>
<span class="functioncall">class</span><span class="keyword">(</span><span class="symbol">translationTable</span><span class="keyword">)</span></div><div class="output">[1] "data.frame"
</div></pre>
</section>
<section><h2>The R terminology for a table is a &ldquo;data.frame&rdquo;</h2>

<p>How does the structure of translationTable related to our original file?</p>

<table><thead>
<tr>
<th>row.names</th>
<th>aminoacid</th>
</tr>
</thead><tbody>
<tr>
<td>GCU</td>
<td>A</td>
</tr>
<tr>
<td>GCC</td>
<td>A</td>
</tr>
<tr>
<td>GCA</td>
<td>A</td>
</tr>
</tbody></table>

<p>The relationship between the column headings in a data.frame the the original file can be a bit tricky to understand when you first start working with tables in R.</p>
</section>
<section><h2>Two flavors of data.frame (depending on your data)</h2>

<ul>
<li>Unique values in the 1st column (row.names)</li>
<li>Non-unique values in the 1st column (no row.names)</li>
</ul>

<p>When you use one of the simple read.* functions, R will try to figure out whether or not it can treat the values in the left-most column as unique.  If it can, it will make a <code>data.frame</code> with a <code>row.names</code> column on the left side of the table.  In this case, you want the heading line of your file to have one <em>fewer</em> labels than you have columns.  See how I didn this in translationTable.txt?</p>

<p>If your left most column does <strong>not</strong> contain unique values, R will add a new left-hand column that just contains numbers (1..n where n is the number of rows you have).  You&#39;ll see why we want to have some kind of unique label for each row in our <code>data.frame</code> objects in a moment.</p>
</section></section>
<section><h1>Sidebar:  Extract &amp; Replace</h1>

<p>Remember how we mentioned that the fundamental data type in R is the vector and then I promised that this would be both hard for you to wrap your heads around at first, but also extremely powerful?  Well, prepare to have your minds blown because we&#39;re about to see our first real <code>vectorized</code> operations in R!</p>

<section><h2>Let&#39;s say we have a vector of numbers:</h2>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span> <span class="assignement">&lt;-</span> <span class="functioncall">c</span><span class="keyword">(</span><span class="number">10</span><span class="keyword">,</span><span class="number">20</span><span class="keyword">,</span><span class="number">30</span><span class="keyword">,</span><span class="number">40</span><span class="keyword">,</span><span class="number">50</span><span class="keyword">)</span></div></pre>

<p>Here&#39;s how we can <code>extract</code> a subset of vector:</p>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="number">1</span><span class="keyword">]</span></div><div class="output">[1] 10
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="number">3</span><span class="keyword">]</span></div><div class="output">[1] 30
</div></pre>
</section>
<section><h2>What if we want more than one at once?</h2>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="functioncall">c</span><span class="keyword">(</span><span class="number">1</span><span class="keyword">,</span><span class="number">3</span><span class="keyword">)</span><span class="keyword">]</span></div><div class="output">[1] 10 30
</div></pre>

<p>What happened there?</p>
</section>
<section><h2>How can we extract a range of numbers?</h2>

<pre class="knitr"><div class="source"><span class="comment"># The : operator creates a series of numbers</span>
<span class="number">1</span><span class="keyword">:</span><span class="number">5</span></div><div class="output">[1] 1 2 3 4 5
</div><div class="source"><span class="number">2</span><span class="keyword">:</span><span class="number">10</span></div><div class="output">[1]  2  3  4  5  6  7  8  9 10
</div><div class="source">
<span class="comment"># We can use this inside of our [...]</span>
<span class="symbol">myNumbers</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="number">2</span><span class="keyword">:</span><span class="number">3</span><span class="keyword">]</span></div><div class="output">[1] 20 30
</div></pre>
</section>
<section><h2>We can also use logical vectors</h2>

<p>TRUE = keep it<br/>
FALSE = don&#39;t</p>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="functioncall">c</span><span class="keyword">(</span><span class="number">FALSE</span><span class="keyword">,</span><span class="number">TRUE</span><span class="keyword">,</span><span class="number">TRUE</span><span class="keyword">,</span><span class="number">TRUE</span><span class="keyword">,</span><span class="number">TRUE</span><span class="keyword">)</span><span class="keyword">]</span></div><div class="output">[1] 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="functioncall">c</span><span class="keyword">(</span><span class="number">TRUE</span><span class="keyword">,</span><span class="number">FALSE</span><span class="keyword">,</span><span class="number">FALSE</span><span class="keyword">,</span><span class="number">FALSE</span><span class="keyword">,</span><span class="number">FALSE</span><span class="keyword">)</span><span class="keyword">]</span></div><div class="output">[1] 10
</div></pre>
</section>
<section><h2>Now things get interesting!</h2>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="number">TRUE</span><span class="keyword">]</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="functioncall">c</span><span class="keyword">(</span><span class="number">TRUE</span><span class="keyword">,</span><span class="number">FALSE</span><span class="keyword">)</span><span class="keyword">]</span></div><div class="output">[1] 10 30 50
</div></pre>
</section>
<section><h2>All operations in R are vectorized&hellip;</h2>

<p>Yeasterday we saw that the <code>+</code> works on vectors. </p>

<p>Others basic math operators:</p>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span> <span class="keyword">+</span> <span class="number">5</span></div><div class="output">[1] 15 25 35 45 55
</div><div class="source"><span class="symbol">myNumbers</span> <span class="keyword">-</span> <span class="number">5</span></div><div class="output">[1]  5 15 25 35 45
</div><div class="source"><span class="symbol">myNumbers</span> <span class="keyword">*</span> <span class="functioncall">c</span><span class="keyword">(</span><span class="number">10</span><span class="keyword">,</span><span class="number">0</span><span class="keyword">)</span></div><div class="output">[1] 100   0 300   0 500
</div><div class="source"><span class="symbol">myNumbers</span> <span class="keyword">/</span> <span class="number">0.1</span></div><div class="output">[1] 100 200 300 400 500
</div></pre>
</section>
<section><h2>&hellip;including comparison!</h2>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span> <span class="keyword">&gt;</span> <span class="number">25</span></div><div class="output">[1] FALSE FALSE  TRUE  TRUE  TRUE
</div><div class="source"><span class="symbol">myNumbers</span> <span class="keyword">&lt;</span> <span class="number">25</span></div><div class="output">[1]  TRUE  TRUE FALSE FALSE FALSE
</div><div class="source">
<span class="comment">#Equality comparison uses == instead of =</span>
<span class="symbol">myNumbers</span> == <span class="number">30</span></div><div class="output">[1] FALSE FALSE  TRUE FALSE FALSE
</div><div class="source">
<span class="comment"># The `!` operator negates logical vectors ("not")</span>
<span class="symbol">myNumbers</span> <span class="keyword">!=</span> <span class="number">30</span></div><div class="output">[1]  TRUE  TRUE FALSE  TRUE  TRUE
</div><div class="source"><span class="keyword">!</span><span class="keyword">(</span><span class="symbol">myNumbers</span> <span class="keyword">&gt;</span> <span class="number">25</span><span class="keyword">)</span></div><div class="output">[1]  TRUE  TRUE FALSE FALSE FALSE
</div></pre>

<p>To compare equality we use the <code>==</code> operator.  This is to prevent confusion with the <code>=</code> which is used to pass arguments to functions (or do asignment like <code>&lt;-</code>).  This will probably trip you up at first, but you&#39;ll get used to it.  See what happens if you run <code>myNumbers = 30</code>.</p>
</section>
<section><h2>So what does it all mean?</h2>

<p>We can use our extraction operators <code>[</code> <code>]</code> to filter data in our vectors.</p>

<p>This is a very common idiom in R:</p>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="symbol">myNumbers</span> <span class="keyword">&gt;</span> <span class="number">25</span><span class="keyword">]</span></div><div class="output">[1] 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="symbol">myNumbers</span> <span class="keyword">&lt;</span> <span class="number">25</span><span class="keyword">]</span></div><div class="output">[1] 10 20
</div></pre>
</section>
<section><h2>You can get fancy&hellip;</h2>

<p>Explore the parts of this code, then explain what it does:</p>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span> <span class="keyword">(</span><span class="symbol">myNumbers</span> <span class="keyword">%%</span> <span class="number">4</span><span class="keyword">)</span> == <span class="number">0</span> <span class="keyword">]</span></div><div class="output">[1] 20 40
</div></pre>
</section>
<section><h2>You can use [] to replace data too!</h2>

<pre class="knitr"><div class="source"><span class="symbol">myNumbers</span></div><div class="output">[1] 10 20 30 40 50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="number">3</span><span class="keyword">]</span> <span class="assignement">&lt;-</span> <span class="number">100</span>
<span class="symbol">myNumbers</span></div><div class="output">[1]  10  20 100  40  50
</div><div class="source"><span class="symbol">myNumbers</span><span class="keyword">[</span><span class="number">2</span><span class="keyword">:</span><span class="number">3</span><span class="keyword">]</span> <span class="assignement">&lt;-</span> <span class="functioncall">c</span><span class="keyword">(</span><span class="number">1</span><span class="keyword">,</span><span class="number">2</span><span class="keyword">)</span>
<span class="symbol">myNumbers</span></div><div class="output">[1] 10  1  2 40 50
</div></pre>
</section></section>
<section><h1>Back to our table</h1>

<section><h2>The [] operators work with data.frames as well</h2>

<pre class="knitr"><div class="source"><span class="comment"># You can subset tables on a column: table[col]</span>
<span class="comment">## translationTable[1]</span>

<span class="comment"># You can subset tables on both a row and a column</span>
<span class="symbol">translationTable</span><span class="keyword">[</span><span class="number">3</span><span class="keyword">,</span><span class="number">1</span><span class="keyword">]</span></div><div class="output">[1] "A"
</div><div class="source">
<span class="comment">#If you leave out the column, but keep the , you'll get all columns</span>
<span class="symbol">translationTable</span><span class="keyword">[</span><span class="number">3</span><span class="keyword">,</span><span class="keyword">]</span></div><div class="output">[1] "A"
</div></pre>
</section>
<section><h2>You can use text to refer to columns or rows by name</h2>

<p>Only works for rows if your <code>data.frame</code> has unique <code>row.name</code>&#39;s</p>

<pre class="knitr"><div class="source"><span class="symbol">translationTable</span><span class="keyword">[</span><span class="string">"GUC"</span><span class="keyword">,</span><span class="string">"aminoacid"</span><span class="keyword">]</span></div><div class="output">[1] "V"
</div><div class="source"><span class="symbol">translationTable</span><span class="keyword">[</span><span class="string">"GUC"</span><span class="keyword">,</span><span class="keyword">]</span></div><div class="output">[1] "V"
</div><div class="source">
<span class="comment">#Oh hey!  Remember vectors?</span>
<span class="symbol">translationTable</span><span class="keyword">[</span><span class="functioncall">c</span><span class="keyword">(</span><span class="string">"GUA"</span><span class="keyword">,</span><span class="string">"UAG"</span><span class="keyword">)</span><span class="keyword">,</span><span class="keyword">]</span></div><div class="output">[1] "V" "X"
</div><div class="source">
<span class="comment">#... and logicals?</span>
<span class="symbol">translationTable</span><span class="keyword">[</span><span class="functioncall">c</span><span class="keyword">(</span><span class="number">TRUE</span><span class="keyword">,</span><span class="number">FALSE</span><span class="keyword">)</span><span class="keyword">,</span><span class="keyword">]</span></div><div class="output"> [1] "A" "A" "R" "R" "R" "N" "D" "C" "Q" "E" "G" "G" "H" "I" "I" "L" "L"
[18] "L" "K" "F" "P" "P" "S" "S" "S" "T" "T" "W" "Y" "V" "V" "X"
</div></pre>
</section>
<section><h2>A couple other tricks&hellip;</h2>

<pre class="knitr"><div class="source"><span class="comment">#If your table has row names, you can get a vector of them with:</span>
<span class="functioncall">row.names</span><span class="keyword">(</span><span class="symbol">translationTable</span><span class="keyword">)</span></div><div class="output"> [1] "GCU" "GCC" "GCA" "GCG" "CGU" "CGC" "CGA" "CGG" "AGA" "AGG" "AAU"
[12] "AAC" "GAU" "GAC" "UGU" "UGC" "CAA" "CAG" "GAA" "GAG" "GGU" "GGC"
[23] "GGA" "GGG" "CAU" "CAC" "AUU" "AUC" "AUA" "AUG" "UUA" "UUG" "CUU"
[34] "CUC" "CUA" "CUG" "AAA" "AAG" "UUU" "UUC" "CCU" "CCC" "CCA" "CCG"
[45] "UCU" "UCC" "UCA" "UCG" "AGU" "AGC" "ACU" "ACC" "ACA" "ACG" "UGG"
[56] "UAU" "UAC" "GUU" "GUC" "GUA" "GUG" "UAA" "UGA" "UAG"
</div><div class="source">
<span class="comment">#The $ is a short hand notation for selecting a column of data from a table</span>
<span class="symbol">translationTable</span><span class="keyword">$</span><span class="symbol">aminoacid</span></div><div class="output"> [1] "A" "A" "A" "A" "R" "R" "R" "R" "R" "R" "N" "N" "D" "D" "C" "C" "Q"
[18] "Q" "E" "E" "G" "G" "G" "G" "H" "H" "I" "I" "I" "M" "L" "L" "L" "L"
[35] "L" "L" "K" "K" "F" "F" "P" "P" "P" "P" "S" "S" "S" "S" "S" "S" "T"
[52] "T" "T" "T" "W" "Y" "Y" "V" "V" "V" "V" "X" "X" "X"
</div></pre>
</section>
<section><h2>Your turn #1</h2>

<p>Subset the table to return a vector of all of the codons which encode valine<br/>
&ldquo;V&rdquo;</p>
</section>
<section><h2>Your turn #2</h2>

<p>Write a function that takes a RNA codon and returns the amino acid.</p>

<pre class="knitr"><div class="source"><span class="symbol">translateRNA</span> <span class="assignement">&lt;-</span> <span class="keyword">function</span><span class="keyword">(</span><span class="formalargs">codon</span><span class="keyword">)</span> <span class="keyword">{</span>

  <span class="comment">#Insert your code here</span>

<span class="keyword">}</span></div></pre>

<p>Make sure it works:</p>

<pre class="knitr"><div class="source"><span class="functioncall">translateRNA</span><span class="keyword">(</span><span class="string">"UAU"</span><span class="keyword">)</span></div><div class="output">[1] "Y"
</div></pre>

<p>How might this function be useful in a script designed to translate dna.txt?</p>

<p>For a full reference on extraction and replacement operators in R, you can search for &ldquo;[&rdquo; in the Rstudio search box, or run <code>help(&quot;[&quot;)</code> at the prompt.</p>
</section></section>
<section><h1>Subsetting strings</h1>

<p>We&#39;re getting close!  </p>

<p>We can translate codons&hellip;</p>

<pre class="knitr"><div class="source"><span class="functioncall">translateRNA</span><span class="keyword">(</span><span class="string">"UGG"</span><span class="keyword">)</span></div><div class="output">[1] "W"
</div></pre>

<p>&hellip;but we need to be able to read a string of letters in sets of 3.</p>

<pre class="knitr"><div class="source"><span class="symbol">sampleRNA</span> <span class="assignement">&lt;-</span> <span class="string">"GTAGCTGGCAAGTTAATAGAGATGGAAAAC"</span></div></pre>

<section><h2>Side bar: length of a string</h2>

<p>Figuring out the number of characters in a piece of text is a little funny&hellip;</p>

<pre class="knitr"><div class="source"><span class="symbol">sampleRNA</span></div><div class="output">[1] "GTAGCTGGCAAGTTAATAGAGATGGAAAAC"
</div><div class="source"><span class="functioncall">length</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">)</span></div><div class="output">[1] 1
</div><div class="source"><span class="functioncall">length</span><span class="keyword">(</span><span class="functioncall">c</span><span class="keyword">(</span><span class="string">"A"</span><span class="keyword">,</span><span class="string">"B"</span><span class="keyword">)</span><span class="keyword">)</span></div><div class="output">[1] 2
</div><div class="source">
<span class="comment">#Number of characters in a string</span>
<span class="functioncall">nchar</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">)</span></div><div class="output">[1] 30
</div><div class="source"><span class="functioncall">nchar</span><span class="keyword">(</span><span class="functioncall">c</span><span class="keyword">(</span><span class="string">"A"</span><span class="keyword">,</span><span class="string">"B"</span><span class="keyword">)</span><span class="keyword">)</span></div><div class="output">[1] 1 1
</div></pre>

<p>What happened there?</p>
</section>
<section><h2>Side bar: subsetting a string</h2>

<p>Similarly, subsetting a string vector is a little funny&hellip;</p>

<pre class="knitr"><div class="source"><span class="symbol">sampleRNA</span></div><div class="output">[1] "GTAGCTGGCAAGTTAATAGAGATGGAAAAC"
</div><div class="source"><span class="symbol">sampleRNA</span><span class="keyword">[</span><span class="number">1</span><span class="keyword">]</span></div><div class="output">[1] "GTAGCTGGCAAGTTAATAGAGATGGAAAAC"
</div><div class="source"><span class="functioncall">c</span><span class="keyword">(</span><span class="string">"A"</span><span class="keyword">,</span><span class="string">"B"</span><span class="keyword">)</span><span class="keyword">[</span><span class="number">1</span><span class="keyword">]</span></div><div class="output">[1] "A"
</div><div class="source"><span class="symbol">sampleRNA</span><span class="keyword">[</span><span class="number">1</span><span class="keyword">:</span><span class="number">2</span><span class="keyword">]</span></div><div class="output">[1] "GTAGCTGGCAAGTTAATAGAGATGGAAAAC" NA                              
</div><div class="source"><span class="functioncall">c</span><span class="keyword">(</span><span class="string">"A"</span><span class="keyword">,</span><span class="string">"B"</span><span class="keyword">)</span><span class="keyword">[</span><span class="number">1</span><span class="keyword">:</span><span class="number">2</span><span class="keyword">]</span></div><div class="output">[1] "A" "B"
</div><div class="source">
<span class="comment"># Use substr to pull characters out of a string</span>
<span class="functioncall">substr</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">,</span> <span class="argument">start</span> <span class="argument">=</span> <span class="number">1</span><span class="keyword">,</span> <span class="argument">stop</span> <span class="argument">=</span> <span class="number">3</span><span class="keyword">)</span></div><div class="output">[1] "GTA"
</div><div class="source"><span class="functioncall">substr</span><span class="keyword">(</span><span class="functioncall">c</span><span class="keyword">(</span><span class="string">"ABCD"</span><span class="keyword">,</span><span class="string">"EFGH"</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">start</span> <span class="argument">=</span> <span class="number">1</span><span class="keyword">,</span> <span class="argument">stop</span> <span class="argument">=</span> <span class="number">3</span><span class="keyword">)</span></div><div class="output">[1] "ABC" "EFG"
</div></pre>
</section>
<section><h2>Subsetting some codons</h2>

<p>Our first codon is&hellip;</p>

<pre class="knitr"><div class="source"><span class="functioncall">substr</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">,</span> <span class="argument">start</span> <span class="argument">=</span> <span class="number">1</span><span class="keyword">,</span> <span class="argument">stop</span> <span class="argument">=</span> <span class="number">3</span><span class="keyword">)</span></div><div class="output">[1] "GTA"
</div></pre>

<p>Our second codon is&hellip;</p>

<pre class="knitr"><div class="source"><span class="functioncall">substr</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">,</span> <span class="argument">start</span> <span class="argument">=</span> <span class="number">4</span><span class="keyword">,</span> <span class="argument">stop</span> <span class="argument">=</span> <span class="number">6</span><span class="keyword">)</span></div><div class="output">[1] "GCT"
</div></pre>

<p>Our third codon is&hellip;</p>

<pre class="knitr"><div class="source"><span class="functioncall">substr</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">,</span> <span class="argument">start</span> <span class="argument">=</span> <span class="number">7</span><span class="keyword">,</span> <span class="argument">stop</span> <span class="argument">=</span> <span class="number">9</span><span class="keyword">)</span></div><div class="output">[1] "GGC"
</div></pre>
</section>
<section><h2>Seeing the pattern</h2>

<p>Our n&#39;th codon is&hellip;</p>

<pre class="knitr"><div class="source"><span class="symbol">n</span> <span class="assignement">&lt;-</span> <span class="number">4</span>
<span class="functioncall">substr</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">,</span> <span class="argument">start</span> <span class="argument">=</span> <span class="keyword">(</span><span class="symbol">n</span> <span class="keyword">*</span> <span class="number">3</span><span class="keyword">)</span> <span class="keyword">-</span> <span class="number">2</span><span class="keyword">,</span> <span class="argument">stop</span> <span class="argument">=</span> <span class="symbol">n</span> <span class="keyword">*</span> <span class="number">3</span><span class="keyword">)</span></div><div class="output">[1] "AAG"
</div></pre>

<p>Our last codon is&hellip;</p>

<pre class="knitr"><div class="source"><span class="functioncall">substr</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">,</span> <span class="argument">start</span> <span class="argument">=</span> <span class="functioncall">nchar</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">)</span> <span class="keyword">-</span> <span class="number">2</span><span class="keyword">,</span> <span class="argument">stop</span> <span class="argument">=</span> <span class="functioncall">nchar</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">)</span><span class="keyword">)</span></div><div class="output">[1] "AAC"
</div></pre>
</section>
<section><h2>Your turn #3</h2>

<p>Write a function that takes a codon number <code>n</code> and returns the sequence</p>

<pre class="knitr"><div class="source"><span class="symbol">getCodon</span> <span class="assignement">&lt;-</span> <span class="keyword">function</span><span class="keyword">(</span><span class="formalargs">n</span><span class="keyword">)</span> <span class="keyword">{</span>

  <span class="comment">#Insert your code here</span>

<span class="keyword">}</span></div></pre>

<p>Make sure it works:</p>

<pre class="knitr"><div class="source"><span class="functioncall">getCodon</span><span class="keyword">(</span><span class="number">5</span><span class="keyword">)</span></div><div class="output">[1] "TTA"
</div></pre>
</section>
<section><h2>Almost there..</h2>

<p>That&#39;s great, but now we need to generate a series of codon numbers (1..n)</p>

<p>We&#39;ve seen the parts that let us do this!</p>

<pre class="knitr"><div class="source"><span class="symbol">codonNumbers</span> <span class="assignement">&lt;-</span> <span class="number">1</span><span class="keyword">:</span><span class="keyword">(</span> <span class="functioncall">nchar</span><span class="keyword">(</span><span class="symbol">sampleRNA</span><span class="keyword">)</span> <span class="keyword">/</span> <span class="number">3</span><span class="keyword">)</span>
<span class="symbol">codonNumbers</span></div><div class="output"> [1]  1  2  3  4  5  6  7  8  9 10
</div></pre>
</section></section>
<section><h1>Apply Magic</h1>

<p>The last piece in the puzzle is applying our <code>getCodon</code> to our <code>codonNumbers</code></p>

<p>The *apply family of functions in R is:</p>

<ul>
<li>very powerful</li>
<li>a little overwhelming at first</li>
</ul>

<section><h2>sapply</h2>

<p>For this task we&#39;ll use <strong>s</strong>apply.  We&#39;ll look at the other apply&#39;s later.</p>

<p>Let&#39;s see it in action:</p>

<pre class="knitr"><div class="source"><span class="functioncall">sapply</span><span class="keyword">(</span> <span class="argument">x</span> <span class="argument">=</span> <span class="symbol">codonNumbers</span><span class="keyword">,</span> <span class="argument">FUN</span> <span class="argument">=</span> <span class="symbol">getCodon</span> <span class="keyword">)</span></div><div class="error">Error: argument "X" is missing, with no default
</div></pre>

<p>What happened there?</p>
</section></section>
<section><h1>Task #1</h1>

<section><h2>Put it all together!</h2>

<p>I&#39;ve given you all of the pieces we need to write a translator.<br/>
Now you have to play with them and put it all together.</p>
</section>
<section><h2>The outline of your final function should look like</h2>

<pre class="knitr"><div class="source"><span class="symbol">translate</span> <span class="assignement">&lt;-</span> <span class="keyword">function</span><span class="keyword">(</span><span class="formalargs">dnaFile</span><span class="keyword">)</span> <span class="keyword">{</span>

  <span class="comment">#Do stuff here!</span>

<span class="keyword">}</span></div></pre>
</section></section>
<section><h1>Challenge #1</h1>

<p>Translate all 6 possible open reading frames</p>
</section>
<section><h1>Challenge #2</h1>

<p>Find the open reading frame that is most likely the real one!</p>
</section>
  </div>
  <!-- end of courser content -->

  <!-- JavaScript at the bottom for fast page loading -->
  <script src=js/vendor/jquery-1.7.2.min.js type="text/javascript"></script>
  <script src=js/plugins.js type="text/javascript"></script>
  <script src=js/main.js type="text/javascript"></script>
  <script src=js/vendor/reveal.js type="text/javascript"></script>

</body>
</html>
